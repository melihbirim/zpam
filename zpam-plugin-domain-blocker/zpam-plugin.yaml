manifest_version: "1.0"

plugin:
  name: "domain-blocker"
  version: "1.0.0"
  description: "Advanced domain reputation checker with custom weights, pattern analysis, DNS validation, and comprehensive spam detection"
  author: "ZPAM Team"
  homepage: "https://github.com/zpam/domain-blocker"
  repository: "https://github.com/zpam/domain-blocker"
  license: "MIT"
  type: "content-analyzer"
  tags: ["domain", "reputation", "dns", "pattern-analysis", "security", "disposable-email"]
  min_zpam_version: "2.0.0"

main:
  binary: "./bin/domain-blocker"

interfaces:
  - "ContentAnalyzer"

configuration:
  blocked_domains:
    type: "array"
    required: false
    default: ["suspicious.com", "phishing-site.net", "malware.org", "fakebank.com"]
    description: "List of domains to block completely (highest threat level)"
    examples:
      - ["suspicious.com", "phishing-site.net"]
  
  block_score:
    type: "number"
    required: false
    default: 0.9
    min: 0.0
    max: 1.0
    description: "Spam score assigned to blocked domains"
  
  suspicious_domains:
    type: "object"
    required: false
    default: {"marketing-blast.com": 0.6, "newsletter-spam.net": 0.5}
    description: "Domains with custom suspicion scores (key: domain, value: score 0.0-1.0)"
    examples:
      - {"questionable-sender.com": 0.7, "bulk-email.net": 0.6}
  
  disposable_domains:
    type: "array"
    required: false
    default: ["10minutemail.com", "temp-mail.org", "guerrillamail.com"]
    description: "Known disposable/temporary email providers"
    examples:
      - ["temp-mail.org", "throwaway-email.com"]
  
  disposable_score:
    type: "number"
    required: false
    default: 0.8
    min: 0.0
    max: 1.0
    description: "Score assigned to disposable email providers"
  
  temp_patterns:
    type: "array"
    required: false
    default: ["temp", "temporary", "disposable", "minute", "throw", "test", "spam", "junk"]
    description: "Patterns that indicate temporary/disposable email domains"
    examples:
      - ["temp", "disposable", "fake", "test"]
  
  temp_score:
    type: "number"
    required: false
    default: 0.7
    min: 0.0
    max: 1.0
    description: "Score assigned when temporary patterns are detected"
  
  check_dns:
    type: "boolean"
    required: false
    default: true
    description: "Enable DNS resolution and MX record validation"
  
  no_dns_score:
    type: "number"
    required: false
    default: 0.8
    min: 0.0
    max: 1.0
    description: "Score when domain doesn't resolve"
  
  no_mx_score:
    type: "number"
    required: false
    default: 0.7
    min: 0.0
    max: 1.0
    description: "Score when domain has no MX records"
  
  check_patterns:
    type: "boolean"
    required: false
    default: true
    description: "Enable pattern-based domain analysis"
  
  number_score:
    type: "number"
    required: false
    default: 0.6
    min: 0.0
    max: 1.0
    description: "Score for domains with suspicious number patterns"
  
  suspicious_tlds:
    type: "array"
    required: false
    default: [".tk", ".ml", ".ga", ".cf", ".gq"]
    description: "Top-level domains considered suspicious"
    examples:
      - [".tk", ".ml", ".bit"]
  
  suspicious_tld_score:
    type: "number"
    required: false
    default: 0.7
    min: 0.0
    max: 1.0
    description: "Score assigned to suspicious TLD domains"

security:
  permissions:
    - "network_access"  # Required for DNS lookups and MX record validation
  sandbox: false        # Network access required for DNS operations

performance:
  timeout_ms: 5000     # Maximum execution time
  memory_limit_mb: 64  # Memory usage limit
  concurrent_safe: true # Can be run concurrently

marketplace:
  category: "Content Analysis"
  keywords: ["domain", "reputation", "dns", "security", "blocking", "disposable", "patterns"]
  screenshots:
    - "./docs/example-output.png"
    - "./docs/configuration-guide.png"
  documentation:
    - "./README.md"
    - "./docs/usage-examples.md"

examples:
  - name: "Blocked Domain Detection"
    input: "From: spam@suspicious.com"
    expected_score: 0.9
    description: "Detects domains in the blocked list"
  
  - name: "Disposable Email Detection"
    input: "From: user@10minutemail.com"
    expected_score: 0.8
    description: "Identifies disposable email providers"
  
  - name: "Pattern-Based Detection"
    input: "From: user@temp123email.tk"
    expected_score: 0.7
    description: "Detects suspicious patterns and TLDs"
  
  - name: "Legitimate Domain"
    input: "From: user@gmail.com"
    expected_score: 0.1
    description: "Low score for legitimate domains"
